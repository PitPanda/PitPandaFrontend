{"ast":null,"code":"import _regeneratorRuntime from\"/home/mcpqndq/repos/PitPandaProduction/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _slicedToArray from\"/home/mcpqndq/repos/PitPandaProduction/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _asyncToGenerator from\"/home/mcpqndq/repos/PitPandaProduction/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useEffect,useState}from'react';import queryString from'query-string';import StaticCard from'../Cards/StaticCard';import MinecraftText from'../Minecraft/MinecraftText';import Link from'../Link/Link';import PageSelector from'../PageSelector/PageSelector';import boards from'../../scripts/leaderboards';import{withRouter}from'react-router-dom';var defaultCategory='gapples';function getLeaderboard(_x){return _getLeaderboard.apply(this,arguments);}function _getLeaderboard(){_getLeaderboard=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref){var _ref$category,category,_ref$page,page,pageRequest,json;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_ref$category=_ref.category,category=_ref$category===void 0?defaultCategory:_ref$category,_ref$page=_ref.page,page=_ref$page===void 0?0:_ref$page;_context2.prev=1;_context2.next=4;return fetch(\"/api/leaderboard/\".concat(category,\"?page=\").concat(page));case 4:pageRequest=_context2.sent;_context2.next=7;return pageRequest.json();case 7:json=_context2.sent;console.log(json);if(json.success){_context2.next=11;break;}return _context2.abrupt(\"return\",{error:json.error||'An error occured'});case 11:return _context2.abrupt(\"return\",json.leaderboard);case 14:_context2.prev=14;_context2.t0=_context2[\"catch\"](1);return _context2.abrupt(\"return\",{error:_context2.t0});case 17:case\"end\":return _context2.stop();}}},_callee2,null,[[1,14]]);}));return _getLeaderboard.apply(this,arguments);}function getIndexerStatus(){return _getIndexerStatus.apply(this,arguments);}function _getIndexerStatus(){_getIndexerStatus=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var response,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return fetch('/api/indexer');case 3:response=_context3.sent;if(response.ok){_context3.next=6;break;}return _context3.abrupt(\"return\",{error:response.statusText});case 6:_context3.next=8;return response.json();case 8:data=_context3.sent;console.log(data);return _context3.abrupt(\"return\",data.data);case 13:_context3.prev=13;_context3.t0=_context3[\"catch\"](0);return _context3.abrupt(\"return\",{error:_context3.t0});case 16:case\"end\":return _context3.stop();}}},_callee3,null,[[0,13]]);}));return _getIndexerStatus.apply(this,arguments);}function getQuery(search){var query=queryString.parse(search);return{category:query.category||defaultCategory,page:query.page||0};}function Leaderboard(props){var _useState=useState(getQuery(props.location.search)),_useState2=_slicedToArray(_useState,2),target=_useState2[0],setTarget=_useState2[1];var _useState3=useState({entires:[],loadedType:defaultCategory,loadedPage:0}),_useState4=_slicedToArray(_useState3,2),data=_useState4[0],setData=_useState4[1];var _useState5=useState({online:false}),_useState6=_slicedToArray(_useState5,2),indexData=_useState6[0],setIndexData=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),hiddenLBs=_useState8[0],setHiddenLBs=_useState8[1];useEffect(function(){return props.history.listen(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(location){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:return _context.abrupt(\"return\",setTarget(getQuery(location.search)));case 1:case\"end\":return _context.stop();}}},_callee);}));return function(_x2){return _ref2.apply(this,arguments);};}());});useEffect(function(){var alive=true;getLeaderboard(target).then(function(stats){if(alive){if(stats.error)setData({entires:[],loadedType:target.category,loadedPage:target.page});else setData({entires:stats,loadedType:target.category,loadedPage:target.page});}}).catch(console.error);getIndexerStatus().then(function(indexer){if(alive){if(indexer.error)console.log(indexer.error);else setIndexData(indexer);}}).catch(console.error);return function(){return alive=false;};},[target]);function linkBuilder(n){return\"/leaderboard?category=\".concat(target.category,\"&page=\").concat(n-1);}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"h1\",{className:\"page-header\",style:{marginBottom:'100px',textAlign:'center'}},\"Pit Panda Leade\",/*#__PURE__*/React.createElement(\"span\",{onClick:function onClick(){return setHiddenLBs(!hiddenLBs);}},\"r\"),\"boards\"),/*#__PURE__*/React.createElement(\"div\",{style:{textAlign:'left',width:'1020px',margin:'auto'}},/*#__PURE__*/React.createElement(\"div\",{style:{display:'inline-block',verticalAlign:'top',marginRight:'20px'}},/*#__PURE__*/React.createElement(StaticCard,{title:\"Leaderboard Selector\",style:{width:'350px'}},boards.ownKeys(hiddenLBs).map(function(key){var board=boards[key];return/*#__PURE__*/React.createElement(\"div\",{key:key+target.category},/*#__PURE__*/React.createElement(Link,{href:\"/leaderboard?category=\".concat(key,\"&page=0\")},/*#__PURE__*/React.createElement(MinecraftText,{raw:(key===target.category?'§f':'')+board.short})));})),/*#__PURE__*/React.createElement(StaticCard,{title:\"Indexer Status\",style:{width:'350px'}},/*#__PURE__*/React.createElement(MinecraftText,{className:\"text-title\",raw:'Status: '+(indexData.online?'§2Online':'§4Offline')}),/*#__PURE__*/React.createElement(\"br\",null),indexData.online?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(MinecraftText,{raw:\"Players Queued: \\xA76\".concat(indexData.remaingCount.toLocaleString())}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(MinecraftText,{raw:\"Daily Players Indexed: \\xA76\".concat(indexData.dailyCount.toLocaleString())}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(MinecraftText,{raw:\"Rate: \\xA76\".concat(Math.round(1e5/indexData.checkTimeout)/1e2,\" players/sec\")}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(MinecraftText,{raw:\"Daily Queue Time: \\xA76\".concat(function(){console.log(indexData);var seconds=Math.round(indexData.dailyCount*(1e3/indexData.checkTimeout));return\"\".concat(Math.floor(seconds/3600),\"h \").concat(Math.floor(seconds%3600/60),\"m\");}())}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(MinecraftText,{raw:\"Remaining Queue Time: \\xA76\".concat(function(){var seconds=Math.round(indexData.remaingCount*(1e3/indexData.checkTimeout));return\"\".concat(Math.floor(seconds/3600),\"h \").concat(Math.floor(seconds%3600/60),\"m\");}())}),/*#__PURE__*/React.createElement(\"br\",null)):'')),/*#__PURE__*/React.createElement(StaticCard,{title:boards[data.loadedType].displayName,style:{width:'650px',display:'inline-block'}},data.entires.map(function(user,index){return/*#__PURE__*/React.createElement(\"div\",{key:user.uuid,style:{borderTop:index!==0?'2px solid #444':'none',padding:'5px'}},/*#__PURE__*/React.createElement(MinecraftText,{style:{width:'10%',textAlign:'center',display:'inline-block'},text:\"#\".concat(data.loadedPage*100+index+1)}),/*#__PURE__*/React.createElement(Link,{href:\"/players/\".concat(user.uuid)},/*#__PURE__*/React.createElement(MinecraftText,{raw:user.name,style:{width:'50%'}})),/*#__PURE__*/React.createElement(MinecraftText,{text:boards[data.loadedType].transform(user.score),style:{width:'40%',textAlign:'right',paddingRight:'8px'}}));}),data.entires.length?/*#__PURE__*/React.createElement(PageSelector,{start:1,current:Number(target.page)+1,linkBuilder:linkBuilder}):'')));}export default withRouter(Leaderboard);","map":{"version":3,"sources":["/home/mcpqndq/repos/PitPandaProduction/frontEnd/src/Components/Apps/Leaderboard.js"],"names":["React","useEffect","useState","queryString","StaticCard","MinecraftText","Link","PageSelector","boards","withRouter","defaultCategory","getLeaderboard","category","page","fetch","pageRequest","json","console","log","success","error","leaderboard","getIndexerStatus","response","ok","statusText","data","getQuery","search","query","parse","Leaderboard","props","location","target","setTarget","entires","loadedType","loadedPage","setData","online","indexData","setIndexData","hiddenLBs","setHiddenLBs","history","listen","alive","then","stats","catch","indexer","linkBuilder","n","marginBottom","textAlign","width","margin","display","verticalAlign","marginRight","ownKeys","map","key","board","short","remaingCount","toLocaleString","dailyCount","Math","round","checkTimeout","seconds","floor","displayName","user","index","uuid","borderTop","padding","name","transform","score","paddingRight","length","Number"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport queryString from 'query-string';\nimport StaticCard from '../Cards/StaticCard';\nimport MinecraftText from '../Minecraft/MinecraftText';\nimport Link from '../Link/Link';\nimport PageSelector from '../PageSelector/PageSelector';\nimport boards from '../../scripts/leaderboards';\nimport { withRouter } from 'react-router-dom';\n\nconst defaultCategory = 'gapples';\n\nasync function getLeaderboard({ category = defaultCategory, page = 0 }) {\n    try {\n        const pageRequest = await fetch(`/api/leaderboard/${category}?page=${page}`);\n        const json = await pageRequest.json();\n        console.log(json);\n        if (!json.success) return { error: (json.error || 'An error occured') };\n        return json.leaderboard;\n    } catch (e) {\n        return { error: e };\n    }\n}\n\nasync function getIndexerStatus() {\n    try{\n        const response = await fetch('/api/indexer');\n        if (!response.ok) return {error:response.statusText};\n        const data = await response.json();\n        console.log(data);\n        return data.data;\n    }catch(error){\n        return {error};\n    }\n}\n\nfunction getQuery(search) {\n    let query = queryString.parse(search);\n    return { category: query.category || defaultCategory, page: query.page || 0 };\n}\n\nfunction Leaderboard(props) {\n    const [target, setTarget] = useState(getQuery(props.location.search));\n    const [data, setData] = useState({ entires: [], loadedType: defaultCategory, loadedPage: 0 });\n    const [indexData, setIndexData] = useState({ online: false });\n\n    const [hiddenLBs, setHiddenLBs] = useState(false);\n\n\n    useEffect(() => {\n        return props.history.listen(\n            async location => setTarget(getQuery(location.search))\n        );\n    });\n\n    useEffect(() => {\n        let alive = true;\n        getLeaderboard(target).then(stats=>{\n            if(alive){\n                if (stats.error) setData({ entires: [], loadedType: target.category, loadedPage: target.page });\n                else setData({ entires: stats, loadedType: target.category, loadedPage: target.page });\n            }\n        }).catch(console.error);\n        getIndexerStatus().then(indexer=>{\n            if(alive) {\n                if(indexer.error) console.log(indexer.error);\n                else setIndexData(indexer);\n            }\n        }).catch(console.error);\n        return () => alive = false;\n    }, [target]);\n\n    function linkBuilder(n){\n        return `/leaderboard?category=${target.category}&page=${n-1}`;\n    }\n\n    return (\n        <>\n            <h1 className=\"page-header\" style={{ marginBottom: '100px', textAlign: 'center' }}>Pit Panda Leade<span onClick={ () => setHiddenLBs(!hiddenLBs) }>r</span>boards</h1>\n            <div style={{ textAlign: 'left', width: '1020px', margin: 'auto' }}>\n                <div style={{ display: 'inline-block', verticalAlign: 'top', marginRight: '20px' }}>\n                    <StaticCard title=\"Leaderboard Selector\" style={{ width: '350px' }}>\n                        {boards.ownKeys(hiddenLBs).map(key => {\n                            const board = boards[key];\n                            return (\n                                <div key={key+target.category}>\n                                    <Link href={`/leaderboard?category=${key}&page=0`}>\n                                        <MinecraftText raw={(key===target.category?'§f':'')+board.short}/>\n                                    </Link>\n                                </div>\n                            );\n                        })}\n                    </StaticCard>\n                    <StaticCard title=\"Indexer Status\" style={{ width: '350px' }}>\n                        <MinecraftText className='text-title' raw={'Status: ' + (indexData.online ? '§2Online' : '§4Offline')} /><br />\n                        {indexData.online ? (\n                            <>\n                                <MinecraftText raw={`Players Queued: §6${indexData.remaingCount.toLocaleString()}`} /><br />\n                                <MinecraftText raw={`Daily Players Indexed: §6${indexData.dailyCount.toLocaleString()}`} /><br />\n                                <MinecraftText raw={`Rate: §6${Math.round(1e5/indexData.checkTimeout)/1e2} players/sec`} /><br />\n                                <MinecraftText raw={`Daily Queue Time: §6${(()=>{\n                                    console.log(indexData);\n                                    const seconds = Math.round(indexData.dailyCount*(1e3/indexData.checkTimeout));\n                                    return `${Math.floor(seconds/3600)}h ${Math.floor((seconds%3600)/60)}m`;\n                                })()}`} /><br />\n                                <MinecraftText raw={`Remaining Queue Time: §6${(()=>{\n                                    const seconds = Math.round(indexData.remaingCount*(1e3/indexData.checkTimeout));\n                                    return `${Math.floor(seconds/3600)}h ${Math.floor((seconds%3600)/60)}m`;\n                                })()}`} /><br />\n                            </>\n                        ) : ''}\n                    </StaticCard>\n                </div>\n\n                <StaticCard title={boards[data.loadedType].displayName} style={{ width: '650px', display: 'inline-block' }}>\n                    {data.entires.map((user, index) => (\n                        <div key={user.uuid} style={{ borderTop: (index !== 0 ? '2px solid #444' : 'none'), padding: '5px' }}>\n                            <MinecraftText style={{ width: '10%', textAlign: 'center', display: 'inline-block' }} text={`#${data.loadedPage * 100 + index + 1}`} />\n                            <Link href={`/players/${user.uuid}`}>\n                                <MinecraftText raw={user.name} style={{ width: '50%' }} />\n                            </Link>\n                            <MinecraftText text={boards[data.loadedType].transform(user.score)} style={{ width: '40%', textAlign: 'right', paddingRight: '8px' }} />\n                        </div>\n                    ))}\n                    {data.entires.length?<PageSelector start={1} current={Number(target.page)+1} linkBuilder={linkBuilder}/>:''}\n                </StaticCard>\n            </div>\n        </>\n    );\n}\n\nexport default withRouter(Leaderboard);"]},"metadata":{},"sourceType":"module"}