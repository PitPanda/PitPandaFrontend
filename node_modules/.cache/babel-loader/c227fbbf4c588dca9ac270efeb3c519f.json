{"ast":null,"code":"import _classCallCheck from\"/home/mcpqndq/repos/PitPandaProduction/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/mcpqndq/repos/PitPandaProduction/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/mcpqndq/repos/PitPandaProduction/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/mcpqndq/repos/PitPandaProduction/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component,Fragment}from\"react\";import MinecraftText from'../Minecraft/MinecraftText';import'./SearchField.css';var SearchField=/*#__PURE__*/function(_Component){_inherits(SearchField,_Component);var _super=_createSuper(SearchField);function SearchField(){var _this;_classCallCheck(this,SearchField);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={// The active selection's index\nactiveSuggestion:0,// The suggestions that match the user's input\nfilteredSuggestions:[],// Whether or not the suggestion list is shown\nshowSuggestions:false,// What the user has entered\nuserInput:_this.props.says,reporting:_this.props.says,userNumber:\"\",showNumber:false};_this.numRef=React.createRef();_this.onChange=function(e){var suggestions=_this.props.suggestions;var userInput=e.currentTarget.value.split('').filter(function(str){return /[-+_!\"':a-zA-Z0-9 ]/.test(str);}).join('');// Filter our suggestions that don't contain the user's input\nvar filteredSuggestions=suggestions.filter(function(suggestion){return suggestion[1].Name.replace(/§./g,'').toLowerCase().indexOf(userInput.toLowerCase().replace(/!/,''))>-1;});// Update the user input and filtered suggestions, reset the active\n// suggestion and make sure the suggestions are shown\nvar showNumber=Boolean(_this.props.suggestions.find(function(s){return s[0]===userInput&&!s[1].NoNumber;}));_this.setState({activeSuggestion:0,filteredSuggestions:filteredSuggestions,showSuggestions:true,userInput:userInput,reporting:userInput,showNumber:showNumber,userNumber:showNumber?_this.state.userNumber:''});_this.reportString(userInput,showNumber,_this.state.userNumber,userInput);};_this.onNumberChange=function(e){var userNumber=e.currentTarget.value.split('').filter(function(str){return /[-+><0-9a-zA-Z]/.test(str);}).join('');_this.setState({userNumber:userNumber});_this.reportString(_this.state.reporting,true,userNumber,_this.state.userInput);};_this.onClick=function(e){_this.select(e.currentTarget.getAttribute('index'));};_this.select=function(index){var reporting=_this.state.filteredSuggestions[index][0];var showNumber=Boolean(_this.props.suggestions.find(function(s){return s[0]===reporting&&!s[1].NoNumber;}));if(showNumber)setTimeout(function(){return _this.numRef.current.focus();},0);var userInput=(_this.state.userInput.startsWith('!')?'!':'')+_this.state.filteredSuggestions[index][1].Name.replace(/§./g,'');_this.setState({activeSuggestion:0,filteredSuggestions:[],showSuggestions:false,showNumber:showNumber,reporting:reporting,userNumber:'',userInput:userInput});_this.reportString(reporting,showNumber,_this.state.userNumber,userInput);};_this.onKeyDown=function(e){var _this$state=_this.state,activeSuggestion=_this$state.activeSuggestion,filteredSuggestions=_this$state.filteredSuggestions,showSuggestions=_this$state.showSuggestions;if(e.currentTarget.value!==''&&showSuggestions&&filteredSuggestions.length&&filteredSuggestions.length!==_this.props.suggestions.length){if(e.keyCode===13||e.keyCode===9&&!e.shiftKey){if(filteredSuggestions[activeSuggestion]){_this.select(activeSuggestion);}else{var reporting=e.currentTarget.value;var showNumber=Boolean(_this.props.suggestions.find(function(s){return s[0]===reporting&&!s[1].NoNumber;}));_this.setState({activeSuggestion:0,showSuggestions:false,userInput:e.currentTarget.value,showNumber:showNumber,userNumber:showNumber?_this.state.userNumber:'',reporting:reporting});_this.reportString(reporting,showNumber,_this.state.userNumber,e.currentTarget.value);}}// User pressed the up arrow, decrement the index\nelse if(e.keyCode===38){if(activeSuggestion===0){return;}_this.setState({activeSuggestion:activeSuggestion-1});}// User pressed the down arrow, increment the index\nelse if(e.keyCode===40){if(activeSuggestion+1===filteredSuggestions.length){return;}_this.setState({activeSuggestion:activeSuggestion+1});}}else{if(e.keyCode===8&&e.currentTarget.value==='')return _this.props.kill();else if(e.keyCode===38)_this.props.up();else if(e.keyCode===40)_this.props.down();else if(e.keyCode===13){if(_this.state.showNumber)_this.numRef.current.focus();else _this.props.down();}}};_this.onKeyDownNumber=function(e){if(e.keyCode===8&&e.currentTarget.value==='')_this.props.mainRef.current.focus();else if(e.keyCode===38)_this.props.up();else if(e.keyCode===40||e.keyCode===13)_this.props.down();};_this.onBlur=function(e){_this.props.timeOutFix(setTimeout(function(){return _this.setState({showSuggestions:false});},150));};return _this;}_createClass(SearchField,[{key:\"reportString\",value:function reportString(value,showNumber,number,text){if(text==='')return this.props.report('','');value=value.toLowerCase();number=number.toLowerCase();var not=value.startsWith('!')||text.startsWith('!');if(not)value=value.substring(1);var match=this.props.suggestions.find(function(s){return value===s[0];});if(!match){match=this.props.suggestions.find(function(s){return s[1].Name.replace(/§./g,'').toLowerCase()===value;});if(!match)match=this.props.suggestions.find(function(s){return s[1].Name.replace(/§./g,'').toLowerCase().indexOf(value)>-1;});if(match){if(!showNumber&&!match[1].NoNumber){showNumber=true;number='0+';}if(match[1].Name.replace(/§./g,'').toLowerCase()===value){this.setState({showNumber:!match[1].NoNumber});}value=match[0];}}if(value==='color'){var colors=this.props.suggestions.find(function(s){return s[0]==='color';});if(colors&&typeof colors[1].Colors[number]!=='undefined')number=colors[1].Colors[number];}if(typeof number==='undefined'||number==='')number='0+';if(number.startsWith('<'))number=number.substring(1)+'-';if(number.startsWith('>'))number=number.substring(1)+'+';if(not)value='!'+value;this.props.report(value+(showNumber?number:''),text);}},{key:\"render\",value:function render(){var onChange=this.onChange,onNumberChange=this.onNumberChange,onClick=this.onClick,onKeyDown=this.onKeyDown,numRef=this.numRef,onBlur=this.onBlur,onKeyDownNumber=this.onKeyDownNumber,_this$state2=this.state,activeSuggestion=_this$state2.activeSuggestion,filteredSuggestions=_this$state2.filteredSuggestions,showSuggestions=_this$state2.showSuggestions,showNumber=_this$state2.showNumber,userInput=_this$state2.userInput,userNumber=_this$state2.userNumber;var suggestionsListComponent;var tabIndex={};if(!showNumber)tabIndex.tabIndex=-1;if(showSuggestions&&userInput){if(filteredSuggestions.length){suggestionsListComponent=/*#__PURE__*/React.createElement(\"ul\",{className:\"suggestions \".concat(showNumber?'SuggestionsHalf':'')},filteredSuggestions.slice(0,8).map(function(suggestion,index){var className;// Flag the active suggestion with a class\nif(index===activeSuggestion){className=\"suggestion-active\";}return/*#__PURE__*/React.createElement(\"li\",{className:className,key:suggestion[0],onClick:onClick,index:index},/*#__PURE__*/React.createElement(MinecraftText,{raw:suggestion[1].Name}));}));}}return/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(\"input\",{type:\"text\",onChange:onChange,onKeyDown:onKeyDown,value:userInput,onBlur:onBlur,ref:this.props.mainRef,className:\"SearchField \".concat(showNumber?'Half':'')}),/*#__PURE__*/React.createElement(\"input\",Object.assign({type:\"text\",onChange:onNumberChange,onKeyDown:onKeyDownNumber,value:userNumber,className:\"SearchField NumberField \".concat(showNumber?'':'HideField'),ref:numRef},tabIndex)),suggestionsListComponent);}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){return{activeSuggestion:state.activeSuggestion,filteredSuggestions:state.filteredSuggestions,showSuggestions:state.showSuggestions,userInput:props.says,reporting:state.reporting,userNumber:state.userNumber,showNumber:state.showNumber};}}]);return SearchField;}(Component);export default SearchField;","map":{"version":3,"sources":["/home/mcpqndq/repos/PitPandaProduction/frontEnd/src/Components/SearchField/SearchField.js"],"names":["React","Component","Fragment","MinecraftText","SearchField","state","activeSuggestion","filteredSuggestions","showSuggestions","userInput","props","says","reporting","userNumber","showNumber","numRef","createRef","onChange","e","suggestions","currentTarget","value","split","filter","str","test","join","suggestion","Name","replace","toLowerCase","indexOf","Boolean","find","s","NoNumber","setState","reportString","onNumberChange","onClick","select","getAttribute","index","setTimeout","current","focus","startsWith","onKeyDown","length","keyCode","shiftKey","kill","up","down","onKeyDownNumber","mainRef","onBlur","timeOutFix","number","text","report","not","substring","match","colors","Colors","suggestionsListComponent","tabIndex","slice","map","className"],"mappings":"woBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,aAAP,KAA0B,4BAA1B,CACA,MAAO,mBAAP,C,GAEMC,CAAAA,W,+UAEFC,K,CAAQ,CACJ;AACAC,gBAAgB,CAAE,CAFd,CAGJ;AACAC,mBAAmB,CAAE,EAJjB,CAKJ;AACAC,eAAe,CAAE,KANb,CAOJ;AACAC,SAAS,CAAE,MAAKC,KAAL,CAAWC,IARlB,CASJC,SAAS,CAAE,MAAKF,KAAL,CAAWC,IATlB,CAUJE,UAAU,CAAE,EAVR,CAWJC,UAAU,CAAC,KAXP,C,OA0BRC,M,CAASf,KAAK,CAACgB,SAAN,E,OAGTC,Q,CAAW,SAAAC,CAAC,CAAI,IACJC,CAAAA,WADI,CACY,MAAKT,KADjB,CACJS,WADI,CAEZ,GAAMV,CAAAA,SAAS,CAAGS,CAAC,CAACE,aAAF,CAAgBC,KAAhB,CAAsBC,KAAtB,CAA4B,EAA5B,EAAgCC,MAAhC,CAAuC,SAAAC,GAAG,QAAE,uBAAsBC,IAAtB,CAA2BD,GAA3B,CAAF,EAA1C,EAA6EE,IAA7E,CAAkF,EAAlF,CAAlB,CAEA;AACA,GAAMnB,CAAAA,mBAAmB,CAAGY,WAAW,CAACI,MAAZ,CACxB,SAAAI,UAAU,QACNA,CAAAA,UAAU,CAAC,CAAD,CAAV,CAAcC,IAAd,CAAmBC,OAAnB,CAA2B,KAA3B,CAAiC,EAAjC,EAAqCC,WAArC,GAAmDC,OAAnD,CAA2DtB,SAAS,CAACqB,WAAV,GAAwBD,OAAxB,CAAgC,GAAhC,CAAoC,EAApC,CAA3D,EAAsG,CAAC,CADjG,EADc,CAA5B,CAKA;AACA;AACA,GAAMf,CAAAA,UAAU,CAAGkB,OAAO,CAAC,MAAKtB,KAAL,CAAWS,WAAX,CAAuBc,IAAvB,CAA4B,SAAAC,CAAC,QAAEA,CAAAA,CAAC,CAAC,CAAD,CAAD,GAAOzB,SAAP,EAAkB,CAACyB,CAAC,CAAC,CAAD,CAAD,CAAKC,QAA1B,EAA7B,CAAD,CAA1B,CACA,MAAKC,QAAL,CAAc,CACV9B,gBAAgB,CAAE,CADR,CAEVC,mBAAmB,CAAnBA,mBAFU,CAGVC,eAAe,CAAE,IAHP,CAIVC,SAAS,CAAEA,SAJD,CAKVG,SAAS,CAAEH,SALD,CAMVK,UAAU,CAAVA,UANU,CAOVD,UAAU,CAACC,UAAU,CAAC,MAAKT,KAAL,CAAWQ,UAAZ,CAAuB,EAPlC,CAAd,EASA,MAAKwB,YAAL,CAAkB5B,SAAlB,CAA4BK,UAA5B,CAAuC,MAAKT,KAAL,CAAWQ,UAAlD,CAA6DJ,SAA7D,EACH,C,OAkCD6B,c,CAAiB,SAAApB,CAAC,CAAI,CAClB,GAAIL,CAAAA,UAAU,CAAGK,CAAC,CAACE,aAAF,CAAgBC,KAAhB,CAAsBC,KAAtB,CAA4B,EAA5B,EAAgCC,MAAhC,CAAuC,SAAAC,GAAG,QAAE,mBAAkBC,IAAlB,CAAuBD,GAAvB,CAAF,EAA1C,EAAyEE,IAAzE,CAA8E,EAA9E,CAAjB,CACA,MAAKU,QAAL,CAAc,CAACvB,UAAU,CAAVA,UAAD,CAAd,EACA,MAAKwB,YAAL,CAAkB,MAAKhC,KAAL,CAAWO,SAA7B,CAAuC,IAAvC,CAA4CC,UAA5C,CAAuD,MAAKR,KAAL,CAAWI,SAAlE,EACH,C,OAED8B,O,CAAU,SAAArB,CAAC,CAAI,CACX,MAAKsB,MAAL,CAAYtB,CAAC,CAACE,aAAF,CAAgBqB,YAAhB,CAA6B,OAA7B,CAAZ,EACH,C,OAEDD,M,CAAS,SAAAE,KAAK,CAAI,CACd,GAAM9B,CAAAA,SAAS,CAAG,MAAKP,KAAL,CAAWE,mBAAX,CAA+BmC,KAA/B,EAAsC,CAAtC,CAAlB,CACA,GAAM5B,CAAAA,UAAU,CAAGkB,OAAO,CAAC,MAAKtB,KAAL,CAAWS,WAAX,CAAuBc,IAAvB,CAA4B,SAAAC,CAAC,QAAEA,CAAAA,CAAC,CAAC,CAAD,CAAD,GAAOtB,SAAP,EAAkB,CAACsB,CAAC,CAAC,CAAD,CAAD,CAAKC,QAA1B,EAA7B,CAAD,CAA1B,CACA,GAAGrB,UAAH,CAAe6B,UAAU,CAAC,iBAAI,OAAK5B,MAAL,CAAY6B,OAAZ,CAAoBC,KAApB,EAAJ,EAAD,CAAiC,CAAjC,CAAV,CACf,GAAMpC,CAAAA,SAAS,CAAG,CAAC,MAAKJ,KAAL,CAAWI,SAAX,CAAqBqC,UAArB,CAAgC,GAAhC,EAAuC,GAAvC,CAA6C,EAA9C,EAAoD,MAAKzC,KAAL,CAAWE,mBAAX,CAA+BmC,KAA/B,EAAsC,CAAtC,EAAyCd,IAAzC,CAA8CC,OAA9C,CAAsD,KAAtD,CAA4D,EAA5D,CAAtE,CACA,MAAKO,QAAL,CAAc,CACV9B,gBAAgB,CAAE,CADR,CAEVC,mBAAmB,CAAC,EAFV,CAGVC,eAAe,CAAE,KAHP,CAIVM,UAAU,CAAVA,UAJU,CAKVF,SAAS,CAATA,SALU,CAMVC,UAAU,CAAC,EAND,CAOVJ,SAAS,CAATA,SAPU,CAAd,EASA,MAAK4B,YAAL,CAAkBzB,SAAlB,CAA4BE,UAA5B,CAAuC,MAAKT,KAAL,CAAWQ,UAAlD,CAA6DJ,SAA7D,EACH,C,OAEDsC,S,CAAY,SAAA7B,CAAC,CAAI,iBACsD,MAAKb,KAD3D,CACLC,gBADK,aACLA,gBADK,CACaC,mBADb,aACaA,mBADb,CACkCC,eADlC,aACkCA,eADlC,CAEb,GAAGU,CAAC,CAACE,aAAF,CAAgBC,KAAhB,GAAwB,EAAxB,EAA8Bb,eAA9B,EAAiDD,mBAAmB,CAACyC,MAArE,EAA+EzC,mBAAmB,CAACyC,MAApB,GAA+B,MAAKtC,KAAL,CAAWS,WAAX,CAAuB6B,MAAxI,CAA+I,CAC3I,GAAI9B,CAAC,CAAC+B,OAAF,GAAc,EAAd,EAAqB/B,CAAC,CAAC+B,OAAF,GAAc,CAAd,EAAmB,CAAC/B,CAAC,CAACgC,QAA/C,CAA0D,CACtD,GAAG3C,mBAAmB,CAACD,gBAAD,CAAtB,CAAyC,CACrC,MAAKkC,MAAL,CAAYlC,gBAAZ,EACH,CAFD,IAEK,CACD,GAAMM,CAAAA,SAAS,CAAGM,CAAC,CAACE,aAAF,CAAgBC,KAAlC,CACA,GAAMP,CAAAA,UAAU,CAAGkB,OAAO,CAAC,MAAKtB,KAAL,CAAWS,WAAX,CAAuBc,IAAvB,CAA4B,SAAAC,CAAC,QAAEA,CAAAA,CAAC,CAAC,CAAD,CAAD,GAAOtB,SAAP,EAAkB,CAACsB,CAAC,CAAC,CAAD,CAAD,CAAKC,QAA1B,EAA7B,CAAD,CAA1B,CACA,MAAKC,QAAL,CAAc,CACV9B,gBAAgB,CAAE,CADR,CAEVE,eAAe,CAAE,KAFP,CAGVC,SAAS,CAAES,CAAC,CAACE,aAAF,CAAgBC,KAHjB,CAIVP,UAAU,CAAVA,UAJU,CAKVD,UAAU,CAAEC,UAAU,CAAC,MAAKT,KAAL,CAAWQ,UAAZ,CAAuB,EALnC,CAMVD,SAAS,CAATA,SANU,CAAd,EAQA,MAAKyB,YAAL,CAAkBzB,SAAlB,CAA4BE,UAA5B,CAAuC,MAAKT,KAAL,CAAWQ,UAAlD,CAA6DK,CAAC,CAACE,aAAF,CAAgBC,KAA7E,EACH,CACJ,CACD;AAjBA,IAkBK,IAAIH,CAAC,CAAC+B,OAAF,GAAc,EAAlB,CAAsB,CACvB,GAAI3C,gBAAgB,GAAK,CAAzB,CAA4B,CACxB,OACH,CAED,MAAK8B,QAAL,CAAc,CAAE9B,gBAAgB,CAAEA,gBAAgB,CAAG,CAAvC,CAAd,EACH,CACD;AAPK,IAQA,IAAIY,CAAC,CAAC+B,OAAF,GAAc,EAAlB,CAAsB,CACvB,GAAI3C,gBAAgB,CAAG,CAAnB,GAAyBC,mBAAmB,CAACyC,MAAjD,CAAyD,CACrD,OACH,CAED,MAAKZ,QAAL,CAAc,CAAE9B,gBAAgB,CAAEA,gBAAgB,CAAG,CAAvC,CAAd,EACH,CACJ,CAlCD,IAkCK,CACD,GAAIY,CAAC,CAAC+B,OAAF,GAAc,CAAd,EAAmB/B,CAAC,CAACE,aAAF,CAAgBC,KAAhB,GAAwB,EAA/C,CAAmD,MAAO,OAAKX,KAAL,CAAWyC,IAAX,EAAP,CAAnD,IACK,IAAIjC,CAAC,CAAC+B,OAAF,GAAY,EAAhB,CAAoB,MAAKvC,KAAL,CAAW0C,EAAX,GAApB,IACA,IAAIlC,CAAC,CAAC+B,OAAF,GAAY,EAAhB,CAAoB,MAAKvC,KAAL,CAAW2C,IAAX,GAApB,IACA,IAAInC,CAAC,CAAC+B,OAAF,GAAY,EAAhB,CAAoB,CACrB,GAAG,MAAK5C,KAAL,CAAWS,UAAd,CAA0B,MAAKC,MAAL,CAAY6B,OAAZ,CAAoBC,KAApB,GAA1B,IACK,OAAKnC,KAAL,CAAW2C,IAAX,GACR,CACJ,CACJ,C,OAEDC,e,CAAkB,SAAApC,CAAC,CAAI,CACnB,GAAIA,CAAC,CAAC+B,OAAF,GAAc,CAAd,EAAmB/B,CAAC,CAACE,aAAF,CAAgBC,KAAhB,GAAwB,EAA/C,CAAmD,MAAKX,KAAL,CAAW6C,OAAX,CAAmBX,OAAnB,CAA2BC,KAA3B,GAAnD,IACK,IAAI3B,CAAC,CAAC+B,OAAF,GAAY,EAAhB,CAAoB,MAAKvC,KAAL,CAAW0C,EAAX,GAApB,IACA,IAAIlC,CAAC,CAAC+B,OAAF,GAAY,EAAZ,EAAgB/B,CAAC,CAAC+B,OAAF,GAAY,EAAhC,CAAoC,MAAKvC,KAAL,CAAW2C,IAAX,GAC5C,C,OAEDG,M,CAAS,SAAAtC,CAAC,CAAI,CACV,MAAKR,KAAL,CAAW+C,UAAX,CAAsBd,UAAU,CAAC,iBAAI,OAAKP,QAAL,CAAc,CAAE5B,eAAe,CAAE,KAAnB,CAAd,CAAJ,EAAD,CAA+C,GAA/C,CAAhC,EACH,C,yFAlHYa,K,CAAMP,U,CAAW4C,M,CAAOC,I,CAAK,CACtC,GAAGA,IAAI,GAAG,EAAV,CAAc,MAAO,MAAKjD,KAAL,CAAWkD,MAAX,CAAkB,EAAlB,CAAsB,EAAtB,CAAP,CACdvC,KAAK,CAACA,KAAK,CAACS,WAAN,EAAN,CACA4B,MAAM,CAACA,MAAM,CAAC5B,WAAP,EAAP,CACA,GAAI+B,CAAAA,GAAG,CAAGxC,KAAK,CAACyB,UAAN,CAAiB,GAAjB,GAAyBa,IAAI,CAACb,UAAL,CAAgB,GAAhB,CAAnC,CACA,GAAGe,GAAH,CAAQxC,KAAK,CAAGA,KAAK,CAACyC,SAAN,CAAgB,CAAhB,CAAR,CACR,GAAIC,CAAAA,KAAK,CAAG,KAAKrD,KAAL,CAAWS,WAAX,CAAuBc,IAAvB,CAA4B,SAAAC,CAAC,QAAEb,CAAAA,KAAK,GAAGa,CAAC,CAAC,CAAD,CAAX,EAA7B,CAAZ,CACA,GAAG,CAAC6B,KAAJ,CAAU,CACNA,KAAK,CAAG,KAAKrD,KAAL,CAAWS,WAAX,CAAuBc,IAAvB,CAA4B,SAAAC,CAAC,QAAEA,CAAAA,CAAC,CAAC,CAAD,CAAD,CAAKN,IAAL,CAAUC,OAAV,CAAkB,KAAlB,CAAwB,EAAxB,EAA4BC,WAA5B,KAA8CT,KAAhD,EAA7B,CAAR,CACA,GAAG,CAAC0C,KAAJ,CAAWA,KAAK,CAAG,KAAKrD,KAAL,CAAWS,WAAX,CAAuBc,IAAvB,CAA4B,SAAAC,CAAC,QAAEA,CAAAA,CAAC,CAAC,CAAD,CAAD,CAAKN,IAAL,CAAUC,OAAV,CAAkB,KAAlB,CAAwB,EAAxB,EAA4BC,WAA5B,GAA0CC,OAA1C,CAAkDV,KAAlD,EAA2D,CAAC,CAA9D,EAA7B,CAAR,CACX,GAAG0C,KAAH,CAAU,CACN,GAAG,CAACjD,UAAD,EAAa,CAACiD,KAAK,CAAC,CAAD,CAAL,CAAS5B,QAA1B,CAAmC,CAC/BrB,UAAU,CAAC,IAAX,CACA4C,MAAM,CAAC,IAAP,CACH,CACD,GAAGK,KAAK,CAAC,CAAD,CAAL,CAASnC,IAAT,CAAcC,OAAd,CAAsB,KAAtB,CAA4B,EAA5B,EAAgCC,WAAhC,KAAgDT,KAAnD,CAA0D,CACtD,KAAKe,QAAL,CAAc,CAACtB,UAAU,CAAC,CAACiD,KAAK,CAAC,CAAD,CAAL,CAAS5B,QAAtB,CAAd,EACH,CACDd,KAAK,CAAI0C,KAAK,CAAC,CAAD,CAAd,CACH,CACJ,CACD,GAAG1C,KAAK,GAAG,OAAX,CAAmB,CACf,GAAM2C,CAAAA,MAAM,CAAG,KAAKtD,KAAL,CAAWS,WAAX,CAAuBc,IAAvB,CAA4B,SAAAC,CAAC,QAAEA,CAAAA,CAAC,CAAC,CAAD,CAAD,GAAO,OAAT,EAA7B,CAAf,CACA,GAAG8B,MAAM,EAAE,MAAOA,CAAAA,MAAM,CAAC,CAAD,CAAN,CAAUC,MAAV,CAAiBP,MAAjB,CAAP,GAAoC,WAA/C,CAA4DA,MAAM,CAACM,MAAM,CAAC,CAAD,CAAN,CAAUC,MAAV,CAAiBP,MAAjB,CAAP,CAC/D,CACD,GAAG,MAAOA,CAAAA,MAAP,GAAkB,WAAlB,EAAiCA,MAAM,GAAG,EAA7C,CAAiDA,MAAM,CAAG,IAAT,CACjD,GAAGA,MAAM,CAACZ,UAAP,CAAkB,GAAlB,CAAH,CAA2BY,MAAM,CAACA,MAAM,CAACI,SAAP,CAAiB,CAAjB,EAAoB,GAA3B,CAC3B,GAAGJ,MAAM,CAACZ,UAAP,CAAkB,GAAlB,CAAH,CAA2BY,MAAM,CAACA,MAAM,CAACI,SAAP,CAAiB,CAAjB,EAAoB,GAA3B,CAC3B,GAAGD,GAAH,CAAQxC,KAAK,CAAG,IAAIA,KAAZ,CACR,KAAKX,KAAL,CAAWkD,MAAX,CAAkBvC,KAAK,EAAEP,UAAU,CAAC4C,MAAD,CAAQ,EAApB,CAAvB,CAAgDC,IAAhD,EACH,C,uCAsFQ,IAED1C,CAAAA,QAFC,CAiBD,IAjBC,CAEDA,QAFC,CAGDqB,cAHC,CAiBD,IAjBC,CAGDA,cAHC,CAIDC,OAJC,CAiBD,IAjBC,CAIDA,OAJC,CAKDQ,SALC,CAiBD,IAjBC,CAKDA,SALC,CAMDhC,MANC,CAiBD,IAjBC,CAMDA,MANC,CAODyC,MAPC,CAiBD,IAjBC,CAODA,MAPC,CAQDF,eARC,CAiBD,IAjBC,CAQDA,eARC,cAiBD,IAjBC,CASDjD,KATC,CAUGC,gBAVH,cAUGA,gBAVH,CAWGC,mBAXH,cAWGA,mBAXH,CAYGC,eAZH,cAYGA,eAZH,CAaGM,UAbH,cAaGA,UAbH,CAcGL,SAdH,cAcGA,SAdH,CAeGI,UAfH,cAeGA,UAfH,CAmBL,GAAIqD,CAAAA,wBAAJ,CAEA,GAAMC,CAAAA,QAAQ,CAAG,EAAjB,CACA,GAAG,CAACrD,UAAJ,CAAgBqD,QAAQ,CAACA,QAAT,CAAkB,CAAC,CAAnB,CAEhB,GAAI3D,eAAe,EAAIC,SAAvB,CAAkC,CAC9B,GAAGF,mBAAmB,CAACyC,MAAvB,CAA8B,CAC1BkB,wBAAwB,cACpB,0BAAI,SAAS,uBAAiBpD,UAAU,CAAC,iBAAD,CAAmB,EAA9C,CAAb,EACKP,mBAAmB,CAAC6D,KAApB,CAA0B,CAA1B,CAA4B,CAA5B,EAA+BC,GAA/B,CAAmC,SAAC1C,UAAD,CAAae,KAAb,CAAuB,CACvD,GAAI4B,CAAAA,SAAJ,CAEA;AACA,GAAI5B,KAAK,GAAKpC,gBAAd,CAAgC,CAC5BgE,SAAS,CAAG,mBAAZ,CACH,CAED,mBACI,0BACI,SAAS,CAAEA,SADf,CAEI,GAAG,CAAE3C,UAAU,CAAC,CAAD,CAFnB,CAGI,OAAO,CAAEY,OAHb,CAII,KAAK,CAAEG,KAJX,eAMI,oBAAC,aAAD,EAAe,GAAG,CAAEf,UAAU,CAAC,CAAD,CAAV,CAAcC,IAAlC,EANJ,CADJ,CAUH,CAlBA,CADL,CADJ,CAuBH,CACJ,CAED,mBACI,oBAAC,QAAD,mBACI,6BACI,IAAI,CAAC,MADT,CAEI,QAAQ,CAAEX,QAFd,CAGI,SAAS,CAAE8B,SAHf,CAII,KAAK,CAAEtC,SAJX,CAKI,MAAM,CAAE+C,MALZ,CAMI,GAAG,CAAE,KAAK9C,KAAL,CAAW6C,OANpB,CAOI,SAAS,uBAAiBzC,UAAU,CAAC,MAAD,CAAQ,EAAnC,CAPb,EADJ,cAUI,2CACI,IAAI,CAAC,MADT,CAEI,QAAQ,CAAEwB,cAFd,CAGI,SAAS,CAAEgB,eAHf,CAII,KAAK,CAAEzC,UAJX,CAKI,SAAS,mCAA6BC,UAAU,CAAC,EAAD,CAAI,WAA3C,CALb,CAMI,GAAG,CAAEC,MANT,EAOQoD,QAPR,EAVJ,CAmBKD,wBAnBL,CADJ,CAuBH,C,4EAvO+BxD,K,CAAML,K,CAAM,CACxC,MAAO,CACHC,gBAAgB,CAACD,KAAK,CAACC,gBADpB,CAEHC,mBAAmB,CAACF,KAAK,CAACE,mBAFvB,CAGHC,eAAe,CAACH,KAAK,CAACG,eAHnB,CAIHC,SAAS,CAACC,KAAK,CAACC,IAJb,CAKHC,SAAS,CAACP,KAAK,CAACO,SALb,CAMHC,UAAU,CAAER,KAAK,CAACQ,UANf,CAOHC,UAAU,CAACT,KAAK,CAACS,UAPd,CAAP,CASH,C,yBA1BqBb,S,EA0P1B,cAAeG,CAAAA,WAAf","sourcesContent":["import React, { Component, Fragment } from \"react\";\nimport MinecraftText from '../Minecraft/MinecraftText';\nimport './SearchField.css';\n\nclass SearchField extends Component {\n\n    state = {\n        // The active selection's index\n        activeSuggestion: 0,\n        // The suggestions that match the user's input\n        filteredSuggestions: [],\n        // Whether or not the suggestion list is shown\n        showSuggestions: false,\n        // What the user has entered\n        userInput: this.props.says,\n        reporting: this.props.says,\n        userNumber: \"\",\n        showNumber:false\n    };\n\n    static getDerivedStateFromProps(props,state){\n        return {\n            activeSuggestion:state.activeSuggestion,\n            filteredSuggestions:state.filteredSuggestions,\n            showSuggestions:state.showSuggestions,\n            userInput:props.says,\n            reporting:state.reporting,\n            userNumber: state.userNumber,\n            showNumber:state.showNumber\n        }\n    }\n\n    numRef = React.createRef();\n\n    // Event fired when the input value is changed\n    onChange = e => {\n        const { suggestions } = this.props;\n        const userInput = e.currentTarget.value.split('').filter(str=>/[-+_!\"':a-zA-Z0-9 ]/.test(str)).join('');\n\n        // Filter our suggestions that don't contain the user's input\n        const filteredSuggestions = suggestions.filter(\n            suggestion =>\n                suggestion[1].Name.replace(/§./g,'').toLowerCase().indexOf(userInput.toLowerCase().replace(/!/,'')) > -1\n        );\n\n        // Update the user input and filtered suggestions, reset the active\n        // suggestion and make sure the suggestions are shown\n        const showNumber = Boolean(this.props.suggestions.find(s=>s[0]===userInput&&!s[1].NoNumber))\n        this.setState({\n            activeSuggestion: 0,\n            filteredSuggestions,\n            showSuggestions: true,\n            userInput: userInput,\n            reporting: userInput,\n            showNumber,\n            userNumber:showNumber?this.state.userNumber:''\n        });\n        this.reportString(userInput,showNumber,this.state.userNumber,userInput);\n    };\n\n    reportString(value,showNumber,number,text){\n        if(text==='') return this.props.report('', '');\n        value=value.toLowerCase();\n        number=number.toLowerCase();\n        let not = value.startsWith('!') || text.startsWith('!');\n        if(not) value = value.substring(1);\n        let match = this.props.suggestions.find(s=>value===s[0]);\n        if(!match){\n            match = this.props.suggestions.find(s=>s[1].Name.replace(/§./g,'').toLowerCase() === value);\n            if(!match) match = this.props.suggestions.find(s=>s[1].Name.replace(/§./g,'').toLowerCase().indexOf(value) > -1);\n            if(match) {\n                if(!showNumber&&!match[1].NoNumber){\n                    showNumber=true;\n                    number='0+';\n                }\n                if(match[1].Name.replace(/§./g,'').toLowerCase()===value) {\n                    this.setState({showNumber:!match[1].NoNumber});\n                }\n                value  = match[0];\n            }\n        }\n        if(value==='color'){\n            const colors = this.props.suggestions.find(s=>s[0]==='color');\n            if(colors&&typeof colors[1].Colors[number] !== 'undefined') number=colors[1].Colors[number];\n        }\n        if(typeof number === 'undefined' || number==='') number = '0+';\n        if(number.startsWith('<')) number=number.substring(1)+'-';\n        if(number.startsWith('>')) number=number.substring(1)+'+';\n        if(not) value = '!'+value;\n        this.props.report(value+(showNumber?number:''), text);\n    }\n\n    onNumberChange = e => {\n        let userNumber = e.currentTarget.value.split('').filter(str=>/[-+><0-9a-zA-Z]/.test(str)).join('');\n        this.setState({userNumber});\n        this.reportString(this.state.reporting,true,userNumber,this.state.userInput);\n    }\n\n    onClick = e => {\n        this.select(e.currentTarget.getAttribute('index'));\n    };  \n\n    select = index => {\n        const reporting = this.state.filteredSuggestions[index][0];\n        const showNumber = Boolean(this.props.suggestions.find(s=>s[0]===reporting&&!s[1].NoNumber));\n        if(showNumber) setTimeout(()=>this.numRef.current.focus(),0);\n        const userInput = (this.state.userInput.startsWith('!') ? '!' : '') + this.state.filteredSuggestions[index][1].Name.replace(/§./g,'');\n        this.setState({\n            activeSuggestion: 0,\n            filteredSuggestions:[],\n            showSuggestions: false,\n            showNumber,\n            reporting,\n            userNumber:'',\n            userInput\n        });\n        this.reportString(reporting,showNumber,this.state.userNumber,userInput);\n    }\n\n    onKeyDown = e => {\n        const { activeSuggestion, filteredSuggestions, showSuggestions } = this.state;\n        if(e.currentTarget.value!=='' && showSuggestions && filteredSuggestions.length && filteredSuggestions.length !== this.props.suggestions.length){\n            if (e.keyCode === 13 || (e.keyCode === 9 && !e.shiftKey)) {\n                if(filteredSuggestions[activeSuggestion]){\n                    this.select(activeSuggestion);\n                }else{\n                    const reporting = e.currentTarget.value;\n                    const showNumber = Boolean(this.props.suggestions.find(s=>s[0]===reporting&&!s[1].NoNumber));\n                    this.setState({\n                        activeSuggestion: 0,\n                        showSuggestions: false,\n                        userInput: e.currentTarget.value,\n                        showNumber,\n                        userNumber: showNumber?this.state.userNumber:'',\n                        reporting\n                    });\n                    this.reportString(reporting,showNumber,this.state.userNumber,e.currentTarget.value);\n                }\n            }\n            // User pressed the up arrow, decrement the index\n            else if (e.keyCode === 38) {\n                if (activeSuggestion === 0) {\n                    return;\n                }\n    \n                this.setState({ activeSuggestion: activeSuggestion - 1 });\n            }\n            // User pressed the down arrow, increment the index\n            else if (e.keyCode === 40) {\n                if (activeSuggestion + 1 === filteredSuggestions.length) {\n                    return;\n                }\n    \n                this.setState({ activeSuggestion: activeSuggestion + 1 });\n            }\n        }else{\n            if (e.keyCode === 8 && e.currentTarget.value==='') return this.props.kill();\n            else if (e.keyCode===38) this.props.up();\n            else if (e.keyCode===40) this.props.down();\n            else if (e.keyCode===13) {\n                if(this.state.showNumber) this.numRef.current.focus();\n                else this.props.down();\n            }\n        }\n    };\n\n    onKeyDownNumber = e => {\n        if (e.keyCode === 8 && e.currentTarget.value==='') this.props.mainRef.current.focus();\n        else if (e.keyCode===38) this.props.up();\n        else if (e.keyCode===40||e.keyCode===13) this.props.down();\n    }\n\n    onBlur = e => {\n        this.props.timeOutFix(setTimeout(()=>this.setState({ showSuggestions: false }),150));\n    }\n\n    render() {\n        const {\n            onChange,\n            onNumberChange,\n            onClick,\n            onKeyDown,\n            numRef,\n            onBlur,\n            onKeyDownNumber,\n            state: {\n                activeSuggestion,\n                filteredSuggestions,\n                showSuggestions,\n                showNumber,\n                userInput,\n                userNumber\n            }\n        } = this;\n\n        let suggestionsListComponent;\n\n        const tabIndex = {};\n        if(!showNumber) tabIndex.tabIndex=-1;\n\n        if (showSuggestions && userInput) {\n            if(filteredSuggestions.length){\n                suggestionsListComponent = (\n                    <ul className={`suggestions ${showNumber?'SuggestionsHalf':''}`}>\n                        {filteredSuggestions.slice(0,8).map((suggestion, index) => {\n                            let className;\n    \n                            // Flag the active suggestion with a class\n                            if (index === activeSuggestion) {\n                                className = \"suggestion-active\";\n                            }\n    \n                            return (\n                                <li\n                                    className={className}\n                                    key={suggestion[0]}\n                                    onClick={onClick}\n                                    index={index}\n                                    >\n                                    <MinecraftText raw={suggestion[1].Name}/>\n                                </li>\n                            );\n                        })}\n                    </ul>\n                );\n            }\n        }\n\n        return (\n            <Fragment>\n                <input\n                    type=\"text\"\n                    onChange={onChange}\n                    onKeyDown={onKeyDown}\n                    value={userInput}\n                    onBlur={onBlur}\n                    ref={this.props.mainRef}\n                    className={`SearchField ${showNumber?'Half':''}`}\n                />\n                <input\n                    type=\"text\"\n                    onChange={onNumberChange}\n                    onKeyDown={onKeyDownNumber}\n                    value={userNumber}\n                    className={`SearchField NumberField ${showNumber?'':'HideField'}`}\n                    ref={numRef}\n                    {...tabIndex}\n                />\n                {suggestionsListComponent}\n            </Fragment>\n        );\n    }\n}\n\nexport default SearchField;"]},"metadata":{},"sourceType":"module"}