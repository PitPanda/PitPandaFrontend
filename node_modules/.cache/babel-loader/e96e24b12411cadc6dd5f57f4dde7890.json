{"ast":null,"code":"var _jsxFileName = \"/home/mcpqndq/repos/PitPandaProduction/frontEnd/src/Components/Apps/ItemSearch.js\";\nimport React from 'react';\nimport MinecraftInventory from '../Minecraft/MinecraftInventory';\nimport StaticCard from '../Cards/StaticCard';\nimport QueryBox from '../QueryBox/QueryBox';\nimport getName, { cache } from '../../scripts/playerName';\nimport { withRouter } from 'react-router-dom';\nconst pageSize = 72;\n\nclass ItemSearch extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      results: new Array(9).fill({\n        fake: true\n      }),\n      loading: false,\n      lastsize: 0,\n      page: 0,\n      queryString: ''\n    };\n\n    this.query = queryString => {\n      if (queryString.length === 0) return this.setState({\n        results: new Array(9).fill({\n          fake: true\n        }),\n        loading: false,\n        lastsize: 0,\n        page: 0,\n        queryString\n      });\n      if (this.state.queryString === queryString) return;\n      this.setState({\n        loading: true,\n        page: 0,\n        queryString\n      });\n      fetch('/api/itemsearch/' + queryString).then(res => res.json()).then(json => {\n        if (!json.success) return;\n        this.readyItems(json.items);\n        const result = json.items.map(item => item.item);\n        console.log(json);\n        this.setState({\n          results: result,\n          loading: false,\n          lastsize: result.length\n        });\n      });\n    };\n\n    this.updatePath = queryString => this.props.history.push(`/itemsearch/${queryString}`);\n\n    this.requestOwner = async index => {\n      if (!this.state.results[index].fake && !this.state.results[index].checked) {\n        let results = this.state.results;\n        let owner = results[index].owner;\n        let targets = results.filter(item => item.owner === owner);\n        let doc = getName(owner);\n        let result = doc.result;\n\n        if (!result) {\n          for (let item of targets) {\n            item.checked = true;\n            item.desc[0] = '§7Owner: Loading';\n          }\n\n          this.setState({\n            results\n          });\n          result = await doc.promise;\n        }\n\n        if (result.error) {\n          for (let item of targets) {\n            item.checked = false;\n            item.desc[0] = '§7Owner: §4ERROR';\n          }\n\n          console.error(result.error);\n        } else {\n          for (let item of targets) {\n            item.desc[0] = `§7Owner: ${result}`;\n          }\n        }\n\n        this.setState({\n          results\n        });\n      }\n    };\n\n    this.readyItems = items => {\n      for (let item of items) {\n        item.item.desc.unshift('§7Lastseen: ' + new Date(item.lastseen * 1000).toLocaleString());\n\n        if (cache[item.owner] && cache[item.owner].result) {\n          item.item.desc.unshift('§7Owner: ' + cache[item.owner].result);\n          item.item.checked = true;\n        } else {\n          item.item.desc.unshift('§7Owner: Click to request');\n          item.item.checked = false;\n        }\n\n        item.item.uuid = item.id;\n        item.item.owner = item.owner;\n      }\n    };\n\n    this.loadMore = () => {\n      this.setState({\n        loading: true,\n        page: this.state.page + 1\n      });\n      fetch(`/api/itemSearch/${this.state.queryString}/${this.state.page + 1}`).then(res => res.json()).then(json => {\n        if (!json.success) return;\n        this.readyItems(json.items);\n        let results = this.state.results;\n        results = results.concat(json.items.map(item => item.item));\n        console.log(json);\n        this.setState({\n          results,\n          loading: false,\n          lastsize: json.items.length\n        });\n      });\n    };\n\n    this.directToOwner = (i, e) => {\n      e.preventDefault();\n      if (this.state.results[i].fake) return;\n\n      if (!e.ctrlKey) {\n        this.props.history.push(`/players/${this.state.results[i].owner}`);\n      } else {\n        let path = `${window.location.origin}/players/${this.state.results[i].owner}`;\n        let win = window.open(path);\n        win.focus();\n      }\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.match.params.query) this.query(this.props.match.params.query);\n    this.unlisten = this.props.history.listen(location => {\n      this.query(location.pathname.substring('/itemsearch/'.length));\n    });\n  }\n\n  componentWillUnmount() {\n    this.unlisten();\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        textAlign: 'center'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      className: \"page-header\",\n      style: {\n        marginBottom: '200px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 17\n      }\n    }, \"Pit Panda Mystic Search\"), /*#__PURE__*/React.createElement(QueryBox, {\n      query: this.updatePath,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        display: 'inline-block',\n        textAlign: 'left',\n        margin: '20px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(StaticCard, {\n      title: \"Results\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(MinecraftInventory, {\n      style: {\n        display: 'block'\n      },\n      key: this.state.queryString,\n      inventory: this.state.results,\n      onContextMenu: this.directToOwner,\n      onClick: this.requestOwner,\n      colors: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 25\n      }\n    }), this.state.lastsize === pageSize && this.state.results.length !== 0 && !this.state.loading ? /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        margin: 'auto',\n        textAlign: 'center'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.loadMore,\n      className: \"srchBtn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 29\n      }\n    }, \"Load More\")) : '')));\n  }\n\n}\n\nexport default withRouter(ItemSearch);","map":{"version":3,"sources":["/home/mcpqndq/repos/PitPandaProduction/frontEnd/src/Components/Apps/ItemSearch.js"],"names":["React","MinecraftInventory","StaticCard","QueryBox","getName","cache","withRouter","pageSize","ItemSearch","Component","state","results","Array","fill","fake","loading","lastsize","page","queryString","query","length","setState","fetch","then","res","json","success","readyItems","items","result","map","item","console","log","updatePath","props","history","push","requestOwner","index","checked","owner","targets","filter","doc","desc","promise","error","unshift","Date","lastseen","toLocaleString","uuid","id","loadMore","concat","directToOwner","i","e","preventDefault","ctrlKey","path","window","location","origin","win","open","focus","componentDidMount","match","params","unlisten","listen","pathname","substring","componentWillUnmount","render","textAlign","marginBottom","display","margin"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,kBAAP,MAA+B,iCAA/B;AACA,OAAOC,UAAP,MAAuB,qBAAvB;AACA,OAAOC,QAAP,MAAqB,sBAArB;AACA,OAAOC,OAAP,IAAiBC,KAAjB,QAA6B,0BAA7B;AACA,SAASC,UAAT,QAA2B,kBAA3B;AAEA,MAAMC,QAAQ,GAAG,EAAjB;;AACA,MAAMC,UAAN,SAAyBR,KAAK,CAACS,SAA/B,CAAyC;AAAA;AAAA;AAAA,SACrCC,KADqC,GAC/B;AACFC,MAAAA,OAAO,EAAC,IAAIC,KAAJ,CAAU,CAAV,EAAaC,IAAb,CAAkB;AAACC,QAAAA,IAAI,EAAC;AAAN,OAAlB,CADN;AAEFC,MAAAA,OAAO,EAAC,KAFN;AAGFC,MAAAA,QAAQ,EAAC,CAHP;AAIFC,MAAAA,IAAI,EAAC,CAJH;AAKFC,MAAAA,WAAW,EAAC;AALV,KAD+B;;AAAA,SAoBrCC,KApBqC,GAoB9BD,WAAD,IAAe;AACjB,UAAGA,WAAW,CAACE,MAAZ,KAAqB,CAAxB,EACI,OAAO,KAAKC,QAAL,CAAc;AAACV,QAAAA,OAAO,EAAC,IAAIC,KAAJ,CAAU,CAAV,EAAaC,IAAb,CAAkB;AAACC,UAAAA,IAAI,EAAC;AAAN,SAAlB,CAAT;AAAwCC,QAAAA,OAAO,EAAC,KAAhD;AAAsDC,QAAAA,QAAQ,EAAC,CAA/D;AAAiEC,QAAAA,IAAI,EAAC,CAAtE;AAAwEC,QAAAA;AAAxE,OAAd,CAAP;AACJ,UAAG,KAAKR,KAAL,CAAWQ,WAAX,KAAyBA,WAA5B,EAAyC;AACzC,WAAKG,QAAL,CAAc;AAACN,QAAAA,OAAO,EAAC,IAAT;AAAcE,QAAAA,IAAI,EAAC,CAAnB;AAAqBC,QAAAA;AAArB,OAAd;AACAI,MAAAA,KAAK,CAAC,qBAAmBJ,WAApB,CAAL,CAAsCK,IAAtC,CAA2CC,GAAG,IAAEA,GAAG,CAACC,IAAJ,EAAhD,EAA4DF,IAA5D,CAAiEE,IAAI,IAAI;AACrE,YAAG,CAACA,IAAI,CAACC,OAAT,EAAkB;AAClB,aAAKC,UAAL,CAAgBF,IAAI,CAACG,KAArB;AACA,cAAMC,MAAM,GAAGJ,IAAI,CAACG,KAAL,CAAWE,GAAX,CAAeC,IAAI,IAAEA,IAAI,CAACA,IAA1B,CAAf;AACAC,QAAAA,OAAO,CAACC,GAAR,CAAYR,IAAZ;AACA,aAAKJ,QAAL,CAAc;AAACV,UAAAA,OAAO,EAACkB,MAAT;AAAgBd,UAAAA,OAAO,EAAC,KAAxB;AAA8BC,UAAAA,QAAQ,EAACa,MAAM,CAACT;AAA9C,SAAd;AACH,OAND;AAOH,KAhCoC;;AAAA,SAkCrCc,UAlCqC,GAkCzBhB,WAAD,IAAe,KAAKiB,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAyB,eAAcnB,WAAY,EAAnD,CAlCW;;AAAA,SAoCrCoB,YApCqC,GAoCvB,MAAOC,KAAP,IAAe;AACzB,UAAG,CAAC,KAAK7B,KAAL,CAAWC,OAAX,CAAmB4B,KAAnB,EAA0BzB,IAA3B,IAAiC,CAAC,KAAKJ,KAAL,CAAWC,OAAX,CAAmB4B,KAAnB,EAA0BC,OAA/D,EAAuE;AACnE,YAAI7B,OAAO,GAAG,KAAKD,KAAL,CAAWC,OAAzB;AACA,YAAI8B,KAAK,GAAG9B,OAAO,CAAC4B,KAAD,CAAP,CAAeE,KAA3B;AAEA,YAAIC,OAAO,GAAG/B,OAAO,CAACgC,MAAR,CAAeZ,IAAI,IAAEA,IAAI,CAACU,KAAL,KAAaA,KAAlC,CAAd;AAEA,YAAIG,GAAG,GAAGxC,OAAO,CAACqC,KAAD,CAAjB;AACA,YAAIZ,MAAM,GAAGe,GAAG,CAACf,MAAjB;;AAEA,YAAG,CAACA,MAAJ,EAAW;AACP,eAAI,IAAIE,IAAR,IAAgBW,OAAhB,EAAwB;AACpBX,YAAAA,IAAI,CAACS,OAAL,GAAe,IAAf;AACAT,YAAAA,IAAI,CAACc,IAAL,CAAU,CAAV,IAAe,kBAAf;AACH;;AACD,eAAKxB,QAAL,CAAc;AAACV,YAAAA;AAAD,WAAd;AACAkB,UAAAA,MAAM,GAAG,MAAMe,GAAG,CAACE,OAAnB;AACH;;AACD,YAAGjB,MAAM,CAACkB,KAAV,EAAiB;AACb,eAAI,IAAIhB,IAAR,IAAgBW,OAAhB,EAAwB;AACpBX,YAAAA,IAAI,CAACS,OAAL,GAAe,KAAf;AACAT,YAAAA,IAAI,CAACc,IAAL,CAAU,CAAV,IAAe,kBAAf;AACH;;AACDb,UAAAA,OAAO,CAACe,KAAR,CAAclB,MAAM,CAACkB,KAArB;AACH,SAND,MAMK;AACD,eAAI,IAAIhB,IAAR,IAAgBW,OAAhB,EAAwB;AACpBX,YAAAA,IAAI,CAACc,IAAL,CAAU,CAAV,IAAgB,YAAWhB,MAAO,EAAlC;AACH;AACJ;;AACD,aAAKR,QAAL,CAAc;AAACV,UAAAA;AAAD,SAAd;AACH;AACJ,KAnEoC;;AAAA,SAqErCgB,UArEqC,GAqEvBC,KAAD,IAAW;AACpB,WAAI,IAAIG,IAAR,IAAgBH,KAAhB,EAAsB;AAClBG,QAAAA,IAAI,CAACA,IAAL,CAAUc,IAAV,CAAeG,OAAf,CAAuB,iBAAe,IAAIC,IAAJ,CAASlB,IAAI,CAACmB,QAAL,GAAc,IAAvB,EAA6BC,cAA7B,EAAtC;;AACA,YAAG9C,KAAK,CAAC0B,IAAI,CAACU,KAAN,CAAL,IAAmBpC,KAAK,CAAC0B,IAAI,CAACU,KAAN,CAAL,CAAkBZ,MAAxC,EAAgD;AAC5CE,UAAAA,IAAI,CAACA,IAAL,CAAUc,IAAV,CAAeG,OAAf,CAAuB,cAAY3C,KAAK,CAAC0B,IAAI,CAACU,KAAN,CAAL,CAAkBZ,MAArD;AACAE,UAAAA,IAAI,CAACA,IAAL,CAAUS,OAAV,GAAoB,IAApB;AACH,SAHD,MAIK;AACDT,UAAAA,IAAI,CAACA,IAAL,CAAUc,IAAV,CAAeG,OAAf,CAAuB,2BAAvB;AACAjB,UAAAA,IAAI,CAACA,IAAL,CAAUS,OAAV,GAAoB,KAApB;AACH;;AACDT,QAAAA,IAAI,CAACA,IAAL,CAAUqB,IAAV,GAAiBrB,IAAI,CAACsB,EAAtB;AACAtB,QAAAA,IAAI,CAACA,IAAL,CAAUU,KAAV,GAAkBV,IAAI,CAACU,KAAvB;AACH;AACJ,KAnFoC;;AAAA,SAqFrCa,QArFqC,GAqF1B,MAAM;AACb,WAAKjC,QAAL,CAAc;AAACN,QAAAA,OAAO,EAAC,IAAT;AAAcE,QAAAA,IAAI,EAAC,KAAKP,KAAL,CAAWO,IAAX,GAAgB;AAAnC,OAAd;AACAK,MAAAA,KAAK,CAAE,mBAAkB,KAAKZ,KAAL,CAAWQ,WAAY,IAAG,KAAKR,KAAL,CAAWO,IAAX,GAAgB,CAAE,EAAhE,CAAL,CAAwEM,IAAxE,CAA6EC,GAAG,IAAEA,GAAG,CAACC,IAAJ,EAAlF,EAA8FF,IAA9F,CAAmGE,IAAI,IAAI;AACvG,YAAG,CAACA,IAAI,CAACC,OAAT,EAAkB;AAClB,aAAKC,UAAL,CAAgBF,IAAI,CAACG,KAArB;AACA,YAAIjB,OAAO,GAAG,KAAKD,KAAL,CAAWC,OAAzB;AACAA,QAAAA,OAAO,GAAGA,OAAO,CAAC4C,MAAR,CAAe9B,IAAI,CAACG,KAAL,CAAWE,GAAX,CAAeC,IAAI,IAAEA,IAAI,CAACA,IAA1B,CAAf,CAAV;AACAC,QAAAA,OAAO,CAACC,GAAR,CAAYR,IAAZ;AACA,aAAKJ,QAAL,CAAc;AAACV,UAAAA,OAAD;AAASI,UAAAA,OAAO,EAAC,KAAjB;AAAuBC,UAAAA,QAAQ,EAACS,IAAI,CAACG,KAAL,CAAWR;AAA3C,SAAd;AACH,OAPD;AAQH,KA/FoC;;AAAA,SAiGrCoC,aAjGqC,GAiGrB,CAACC,CAAD,EAAGC,CAAH,KAAQ;AACpBA,MAAAA,CAAC,CAACC,cAAF;AACA,UAAG,KAAKjD,KAAL,CAAWC,OAAX,CAAmB8C,CAAnB,EAAsB3C,IAAzB,EAA8B;;AAC9B,UAAG,CAAC4C,CAAC,CAACE,OAAN,EAAc;AACV,aAAKzB,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAyB,YAAW,KAAK3B,KAAL,CAAWC,OAAX,CAAmB8C,CAAnB,EAAsBhB,KAAM,EAAhE;AACH,OAFD,MAEK;AACD,YAAIoB,IAAI,GAAI,GAAEC,MAAM,CAACC,QAAP,CAAgBC,MAAO,YAAW,KAAKtD,KAAL,CAAWC,OAAX,CAAmB8C,CAAnB,EAAsBhB,KAAM,EAA5E;AACA,YAAIwB,GAAG,GAAGH,MAAM,CAACI,IAAP,CAAYL,IAAZ,CAAV;AACAI,QAAAA,GAAG,CAACE,KAAJ;AACH;AACJ,KA3GoC;AAAA;;AASrCC,EAAAA,iBAAiB,GAAE;AACf,QAAG,KAAKjC,KAAL,CAAWkC,KAAX,CAAiBC,MAAjB,CAAwBnD,KAA3B,EAAkC,KAAKA,KAAL,CAAW,KAAKgB,KAAL,CAAWkC,KAAX,CAAiBC,MAAjB,CAAwBnD,KAAnC;AAClC,SAAKoD,QAAL,GAAgB,KAAKpC,KAAL,CAAWC,OAAX,CAAmBoC,MAAnB,CAA2BT,QAAD,IAAY;AAClD,WAAK5C,KAAL,CAAW4C,QAAQ,CAACU,QAAT,CAAkBC,SAAlB,CAA4B,eAAetD,MAA3C,CAAX;AACH,KAFe,CAAhB;AAGH;;AAEDuD,EAAAA,oBAAoB,GAAE;AAClB,SAAKJ,QAAL;AACH;;AA2FDK,EAAAA,MAAM,GAAG;AACL,wBACI;AAAK,MAAA,KAAK,EAAE;AAACC,QAAAA,SAAS,EAAC;AAAX,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAI,MAAA,SAAS,EAAC,aAAd;AAA4B,MAAA,KAAK,EAAE;AAACC,QAAAA,YAAY,EAAC;AAAd,OAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCADJ,eAEI,oBAAC,QAAD;AAAU,MAAA,KAAK,EAAE,KAAK5C,UAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFJ,eAGI;AAAK,MAAA,KAAK,EAAE;AAAC6C,QAAAA,OAAO,EAAC,cAAT;AAAwBF,QAAAA,SAAS,EAAC,MAAlC;AAAyCG,QAAAA,MAAM,EAAC;AAAhD,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI,oBAAC,UAAD;AAAY,MAAA,KAAK,EAAC,SAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI,oBAAC,kBAAD;AAAoB,MAAA,KAAK,EAAE;AAACD,QAAAA,OAAO,EAAC;AAAT,OAA3B;AAA8C,MAAA,GAAG,EAAE,KAAKrE,KAAL,CAAWQ,WAA9D;AAA2E,MAAA,SAAS,EAAE,KAAKR,KAAL,CAAWC,OAAjG;AAA0G,MAAA,aAAa,EAAE,KAAK6C,aAA9H;AAA6I,MAAA,OAAO,EAAE,KAAKlB,YAA3J;AAAyK,MAAA,MAAM,EAAE,IAAjL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EAEK,KAAK5B,KAAL,CAAWM,QAAX,KAAsBT,QAAtB,IAAgC,KAAKG,KAAL,CAAWC,OAAX,CAAmBS,MAAnB,KAA4B,CAA5D,IAA+D,CAAC,KAAKV,KAAL,CAAWK,OAA3E,gBACD;AAAK,MAAA,KAAK,EAAE;AAACiE,QAAAA,MAAM,EAAC,MAAR;AAAeH,QAAAA,SAAS,EAAC;AAAzB,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAQ,MAAA,OAAO,EAAE,KAAKvB,QAAtB;AAAgC,MAAA,SAAS,EAAC,SAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADJ,CADC,GAGM,EALX,CADJ,CAHJ,CADJ;AAeH;;AA7HoC;;AAgIzC,eAAehD,UAAU,CAACE,UAAD,CAAzB","sourcesContent":["import React from 'react';\nimport MinecraftInventory from '../Minecraft/MinecraftInventory';\nimport StaticCard from '../Cards/StaticCard';\nimport QueryBox from '../QueryBox/QueryBox';\nimport getName, {cache} from '../../scripts/playerName';\nimport { withRouter } from 'react-router-dom';\n\nconst pageSize = 72;\nclass ItemSearch extends React.Component {\n    state={\n        results:new Array(9).fill({fake:true}),\n        loading:false,\n        lastsize:0,\n        page:0,\n        queryString:''\n    };\n\n    componentDidMount(){\n        if(this.props.match.params.query) this.query(this.props.match.params.query);\n        this.unlisten = this.props.history.listen((location)=>{\n            this.query(location.pathname.substring('/itemsearch/'.length));\n        });\n    }\n\n    componentWillUnmount(){\n        this.unlisten();\n    }\n\n    query=(queryString)=>{\n        if(queryString.length===0)\n            return this.setState({results:new Array(9).fill({fake:true}),loading:false,lastsize:0,page:0,queryString});\n        if(this.state.queryString===queryString) return;\n        this.setState({loading:true,page:0,queryString});\n        fetch('/api/itemsearch/'+queryString).then(res=>res.json()).then(json => {\n            if(!json.success) return;\n            this.readyItems(json.items);\n            const result = json.items.map(item=>item.item);\n            console.log(json);\n            this.setState({results:result,loading:false,lastsize:result.length});\n        });\n    }\n\n    updatePath=(queryString)=>this.props.history.push(`/itemsearch/${queryString}`);\n    \n    requestOwner= async (index)=>{\n        if(!this.state.results[index].fake&&!this.state.results[index].checked){\n            let results = this.state.results;\n            let owner = results[index].owner;\n\n            let targets = results.filter(item=>item.owner===owner);\n\n            let doc = getName(owner);\n            let result = doc.result;\n\n            if(!result){\n                for(let item of targets){\n                    item.checked = true;\n                    item.desc[0] = '§7Owner: Loading';\n                }\n                this.setState({results});\n                result = await doc.promise;\n            }\n            if(result.error) {\n                for(let item of targets){\n                    item.checked = false;\n                    item.desc[0] = '§7Owner: §4ERROR';\n                }\n                console.error(result.error);\n            }else{\n                for(let item of targets){\n                    item.desc[0] = `§7Owner: ${result}`;\n                }\n            }\n            this.setState({results});\n        }\n    }\n\n    readyItems = (items) => {\n        for(let item of items){\n            item.item.desc.unshift('§7Lastseen: '+new Date(item.lastseen*1000).toLocaleString());\n            if(cache[item.owner]&&cache[item.owner].result) {\n                item.item.desc.unshift('§7Owner: '+cache[item.owner].result);\n                item.item.checked = true;\n            }\n            else {\n                item.item.desc.unshift('§7Owner: Click to request');\n                item.item.checked = false;\n            }\n            item.item.uuid = item.id;\n            item.item.owner = item.owner;\n        }\n    }\n\n    loadMore = () => {\n        this.setState({loading:true,page:this.state.page+1})\n        fetch(`/api/itemSearch/${this.state.queryString}/${this.state.page+1}`).then(res=>res.json()).then(json => {\n            if(!json.success) return;\n            this.readyItems(json.items);\n            let results = this.state.results;\n            results = results.concat(json.items.map(item=>item.item));\n            console.log(json);\n            this.setState({results,loading:false,lastsize:json.items.length});\n        });\n    }\n\n    directToOwner = (i,e) =>{\n        e.preventDefault();\n        if(this.state.results[i].fake)return;\n        if(!e.ctrlKey){\n            this.props.history.push(`/players/${this.state.results[i].owner}`);\n        }else{\n            let path = `${window.location.origin}/players/${this.state.results[i].owner}`;\n            let win = window.open(path);\n            win.focus();\n        }\n    }\n\n    render() {\n        return (\n            <div style={{textAlign:'center'}}>\n                <h1 className=\"page-header\" style={{marginBottom:'200px'}}>Pit Panda Mystic Search</h1>\n                <QueryBox query={this.updatePath}/>\n                <div style={{display:'inline-block',textAlign:'left',margin:'20px'}}>\n                    <StaticCard title=\"Results\">\n                        <MinecraftInventory style={{display:'block'}} key={this.state.queryString} inventory={this.state.results} onContextMenu={this.directToOwner} onClick={this.requestOwner} colors={true}/>\n                        {this.state.lastsize===pageSize&&this.state.results.length!==0&&!this.state.loading?\n                        <div style={{margin:'auto',textAlign:'center'}}>\n                            <button onClick={this.loadMore} className='srchBtn'>Load More</button>\n                        </div>:''}\n                    </StaticCard>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default withRouter(ItemSearch);"]},"metadata":{},"sourceType":"module"}